package com.generalfunction.demo.Controller.admin;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;

import com.generalfunction.demo.service.login.UserService;

import lombok.RequiredArgsConstructor;


@Controller
@RequiredArgsConstructor
@RequestMapping("/admin/User-management")
public class Admin {
	private final UserService userService;
	



	 @GetMapping
	    public String listUsers(Model model) {
	        model.addAttribute("users", userService.getAllUsers());
	        return "admin/user-management";
	    }

	    /**
	     * ユーザー削除機能
	     */
	    @PostMapping("/delete/{id}")
	    public String deleteUser(@PathVariable Long id) {
	        userService.deleteUserById(id);
	        return "redirect:/admin/User-management";
	    }

	    /**
	     * admin権限付与機能
	     */
	    @PostMapping("/grant-admin/{id}")
	    public String grantAdminRole(@PathVariable Long id) {
	        userService.grantAdminRole(id);
	        return "redirect:/admin/User-management";
	    }
	}
	
	


